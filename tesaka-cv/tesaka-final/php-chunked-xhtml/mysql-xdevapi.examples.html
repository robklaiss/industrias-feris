    <!DOCTYPE HTML>
    <html>
     <head>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <style>
        .navbar__local {
          flex-grow: 1;
          display: grid;
          grid-auto-flow: column;
          grid-auto-columns: 1fr min-content 1fr;
          margin: 0;
          height: 100%;
          
          .navbar__item {
            align-content: center;
          }
          .navbar__link {
            display: inline;
          }
          .search {
            text-align: center;
          }
          .next {
            text-align: right;
          }
        }
      </style>
      <title>Examples</title>
      <link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

     </head>
     <body class="docs">    <div class="navbar navbar-fixed-top">
      <div class="navbar__inner clearfix">
          <ul class="navbar__local">
            <li class="navbar__item prev"><a href="changelog.mysql_xdevapi.html" class="navbar__link">« Changelog</a></li>
            <li class="navbar__item search">
              <!-- Desktop encanced search -->
              <button
                id="navbar__search-button"
                class="navbar__search-button"
                hidden
              >
                    <svg
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
        width="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
    <circle cx="11" cy="11" r="8"></circle>
    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
                Search
              </button>
            </li>
            <li class="navbar__item next"><a href="ref.mysql-xdevapi.html" class="navbar__link">Mysql_xdevapi Functions »</a></li>
          </ul>
      </div>
    </div>    <div id="breadcrumbs" class="clearfix">
      <ul class="breadcrumbs-container">
        <li><a href="index.html">PHP Manual</a></li>
        <li><a href="book.mysql-xdevapi.html">Mysql_xdevapi</a></li>
        <li>Examples</li>
      </ul>
    </div>    <div id="layout">
      <div id="layout-content"><div id="mysql-xdevapi.examples" class="chapter">
 <h1 class="title">Examples</h1>

 <p class="para">
  The central entry point to the X DevAPI is the <span class="function"><strong>mysql_xdevapi\getSession()</strong></span>
  function, which receives a URI to a MySQL 8.0 Server and returns a
  <span class="classname"><a href="class.mysql-xdevapi-session.html" class="classname">mysql_xdevapi\Session</a></span> object.
 </p>
 <div class="example" id="example-1">
  <p><strong>Example #1 Connecting to a MySQL Server</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">try {<br />    </span><span style="color: #0000BB">$session </span><span style="color: #007700">= </span><span style="color: #0000BB">mysql_xdevapi\getSession</span><span style="color: #007700">(</span><span style="color: #DD0000">"mysqlx://user:password@host"</span><span style="color: #007700">);<br />} catch(</span><span style="color: #0000BB">Exception $e</span><span style="color: #007700">) {<br />    die(</span><span style="color: #DD0000">"Connection could not be established: " </span><span style="color: #007700">. </span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">());<br />}<br /> <br /></span><span style="color: #FF8000">// ... use $session<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
  </div>

 </div>
 <p class="para">
  The session provides full access to the API. For a new MySQL Server installation,
  the first step is to create a database schema with a collection 
  to store data:
 </p>
 <div class="example" id="example-2">
  <p><strong>Example #2 Creating a Schema and Collection on the MySQL Server</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$schema </span><span style="color: #007700">= </span><span style="color: #0000BB">$session</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createSchema</span><span style="color: #007700">(</span><span style="color: #DD0000">"test"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$collection </span><span style="color: #007700">= </span><span style="color: #0000BB">$schema</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCollection</span><span style="color: #007700">(</span><span style="color: #DD0000">"example"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
  </div>

 </div>
 <p class="para">
  When storing data, typically <span class="function"><a href="function.json-encode.html" class="function">json_encode()</a></span> is used to encode
  the data into JSON, which can then be stored inside a collection.
 </p>
 <p class="para">
  The following example stores data into the collection we created earlier, 
  and then retrieve parts of it again.
 </p>
 <div class="example" id="example-3">
  <p><strong>Example #3 Storing and Retrieving Data</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$marco </span><span style="color: #007700">= [<br />  </span><span style="color: #DD0000">"name" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Marco"</span><span style="color: #007700">,<br />  </span><span style="color: #DD0000">"age"  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">19</span><span style="color: #007700">,<br />  </span><span style="color: #DD0000">"job"  </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Programmer"<br /></span><span style="color: #007700">];<br /></span><span style="color: #0000BB">$mike </span><span style="color: #007700">= [<br />  </span><span style="color: #DD0000">"name" </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Mike"</span><span style="color: #007700">,<br />  </span><span style="color: #DD0000">"age"  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">39</span><span style="color: #007700">,<br />  </span><span style="color: #DD0000">"job"  </span><span style="color: #007700">=&gt; </span><span style="color: #DD0000">"Manager"<br /></span><span style="color: #007700">];<br /><br /></span><span style="color: #0000BB">$schema </span><span style="color: #007700">= </span><span style="color: #0000BB">$session</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getSchema</span><span style="color: #007700">(</span><span style="color: #DD0000">"test"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$collection </span><span style="color: #007700">= </span><span style="color: #0000BB">$schema</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCollection</span><span style="color: #007700">(</span><span style="color: #DD0000">"example"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #0000BB">$marco</span><span style="color: #007700">, </span><span style="color: #0000BB">$mike</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">(</span><span style="color: #DD0000">"name = 'Mike'"</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">fetchOne</span><span style="color: #007700">());<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
  </div>

  <div class="example-contents"><p>The above example will output
something similar to:</p></div>
  <div class="example-contents screen">
   <div class="cdata"><pre>
array(4) {
  [&quot;_id&quot;]=&gt;
  string(28) &quot;00005ad66aaf0000000000000003&quot;
  [&quot;age&quot;]=&gt;
  int(39)
  [&quot;job&quot;]=&gt;
  string(7) &quot;Manager&quot;
  [&quot;name&quot;]=&gt;
  string(4) &quot;Mike&quot;
}
</pre></div>
  </div>
 </div>
 <p class="para">
  The example demonstrates that the MySQL Server adds an extra field named
  <code class="code">_id</code>, which serves as primary key to the document.
 </p>
 <p class="para">
  The example also demonstrates that retrieved data is sorted alphabetically.
  That specific order comes from the efficient binary storage inside the MySQL server, but
  it should not be relied upon. Refer to the MySQL JSON datatype documentation for details.
 </p>
 <p class="para">
  Optionally use PHP&#039;s iterators to fetch multiple documents:
 </p>
 <div class="example" id="example-4">
  <p><strong>Example #4 Fetching and Iterating Multiple Documents</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$result </span><span style="color: #007700">= </span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">find</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br />foreach (</span><span style="color: #0000BB">$result </span><span style="color: #007700">as </span><span style="color: #0000BB">$doc</span><span style="color: #007700">) {<br />  echo </span><span style="color: #DD0000">"</span><span style="color: #007700">{</span><span style="color: #0000BB">$doc</span><span style="color: #007700">[</span><span style="color: #DD0000">"name"</span><span style="color: #007700">]}</span><span style="color: #DD0000"> is a </span><span style="color: #007700">{</span><span style="color: #0000BB">$doc</span><span style="color: #007700">[</span><span style="color: #DD0000">"job"</span><span style="color: #007700">]}</span><span style="color: #DD0000">.\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
  </div>

  <div class="example-contents"><p>The above example will output
something similar to:</p></div>
  <div class="example-contents screen">
   <div class="cdata"><pre>
Marco is a Programmer.
Mike is a Manager.
</pre></div>
  </div>
 </div>
</div>
</div></div><script type="text/javascript" src="search-combined.js"></script><script type="text/javascript" src="js/67ae199ee27cc87120cab9ba49d1b776-FuzzySearch.min.js"></script><script type="text/javascript" src="js/f5555778cd757f2cb49676062898832b-search.js"></script>    <div id="search-modal__backdrop" class="search-modal__backdrop">
      <div
        role="dialog"
        aria-label="Search modal"
        id="search-modal"
        class="search-modal"
      >
        <div class="search-modal__header">
          <div class="search-modal__form">
            <div class="search-modal__input-icon">
              <!-- https://feathericons.com search -->
              <svg xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
                width="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            <input
              type="search"
              id="search-modal__input"
              class="search-modal__input"
              placeholder="Search docs"
              aria-label="Search docs"
            />
          </div>
    
          <button aria-label="Close" class="search-modal__close">
            <!-- https://pictogrammers.com/library/mdi/icon/close/ -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
              width="24"
              viewBox="0 0 24 24"
            >
              <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
            </svg>
          </button>
        </div>
        <div
          role="listbox"
          aria-label="Search results"
          id="search-modal__results"
          class="search-modal__results"
        ></div>
        <div class="search-modal__helper-text">
          <div>
            <kbd>↑</kbd> and <kbd>↓</kbd> to navigate •
            <kbd>Enter</kbd> to select •
            <kbd>Esc</kbd> to close • <kbd>/</kbd> to open
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            /*{{{Search Modal*/
            const language = 'local';
            initSearchModal();
            initPHPSearch(language).then((searchCallback) => {
                initSearchUI({language, searchCallback, limit: 30});
            });
            /*}}}*/
        });
    </script></body></html>