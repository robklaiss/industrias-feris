    <!DOCTYPE HTML>
    <html>
     <head>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <style>
        .navbar__local {
          flex-grow: 1;
          display: grid;
          grid-auto-flow: column;
          grid-auto-columns: 1fr min-content 1fr;
          margin: 0;
          height: 100%;
          
          .navbar__item {
            align-content: center;
          }
          .navbar__link {
            display: inline;
          }
          .search {
            text-align: center;
          }
          .next {
            text-align: right;
          }
        }
      </style>
      <title>Process COM messages, sleeping for up to timeoutms milliseconds</title>
      <link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

     </head>
     <body class="docs">    <div class="navbar navbar-fixed-top">
      <div class="navbar__inner clearfix">
          <ul class="navbar__local">
            <li class="navbar__item prev"><a href="function.com-load-typelib.html" class="navbar__link">« com_load_typelib</a></li>
            <li class="navbar__item search">
              <!-- Desktop encanced search -->
              <button
                id="navbar__search-button"
                class="navbar__search-button"
                hidden
              >
                    <svg
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
        width="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
    >
    <circle cx="11" cy="11" r="8"></circle>
    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
                Search
              </button>
            </li>
            <li class="navbar__item next"><a href="function.com-print-typeinfo.html" class="navbar__link">com_print_typeinfo »</a></li>
          </ul>
      </div>
    </div>    <div id="breadcrumbs" class="clearfix">
      <ul class="breadcrumbs-container">
        <li><a href="index.html">PHP Manual</a></li>
        <li><a href="ref.com.html">COM Functions</a></li>
        <li>Process COM messages, sleeping for up to timeoutms milliseconds</li>
      </ul>
    </div>    <div id="layout">
      <div id="layout-content"><div id="function.com-message-pump" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">com_message_pump</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">com_message_pump</span> &mdash; <span class="dc-title">Process COM messages, sleeping for up to timeoutms milliseconds</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.com-message-pump-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>com_message_pump</strong></span>(<span class="methodparam"><span class="type"><a href="language.types.integer.html" class="type int">int</a></span> <code class="parameter">$timeout_milliseconds</code><span class="initializer"> = 0</span></span>): <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span></div>

  <p class="para rdfs-comment">
   This function will sleep for up to <code class="parameter">timeout_milliseconds</code>
   milliseconds, or until a message arrives in the queue.
  </p>
  <p class="para">
   The purpose of this function is to route COM calls between apartments and
   handle various synchronization issues.  This allows your script to wait
   efficiently for events to be triggered, while still handling other events
   or running other code in the background.  You should use it in a loop, as
   demonstrated by the example in the <span class="function"><a href="function.com-event-sink.html" class="function">com_event_sink()</a></span>
   function, until you are finished using event bound COM objects.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.com-message-pump-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>
    
     <dt><code class="parameter">timeout_milliseconds</code></dt>
     <dd>
      <p class="para">
       The timeout, in milliseconds.
      </p>
      <p class="para">
       If you do not specify a value for <code class="parameter">timeout_milliseconds</code>,
       then 0 will be assumed.  A 0 value means that no waiting will be
       performed; if there are messages pending they will be dispatched as
       before; if there are no messages pending, the function will return
       <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong> immediately without sleeping.
      </p>
     </dd>
    
   </dl>
  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.com-message-pump-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   If a message or messages arrives before the timeout, they will be
   dispatched, and the function will return <strong><code><a href="reserved.constants.html#constant.true">true</a></code></strong>. If the timeout occurs and
   no messages were processed, the return value will be <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong>.
  </p>
 </div>

</div></div></div><script type="text/javascript" src="search-combined.js"></script><script type="text/javascript" src="js/67ae199ee27cc87120cab9ba49d1b776-FuzzySearch.min.js"></script><script type="text/javascript" src="js/f5555778cd757f2cb49676062898832b-search.js"></script>    <div id="search-modal__backdrop" class="search-modal__backdrop">
      <div
        role="dialog"
        aria-label="Search modal"
        id="search-modal"
        class="search-modal"
      >
        <div class="search-modal__header">
          <div class="search-modal__form">
            <div class="search-modal__input-icon">
              <!-- https://feathericons.com search -->
              <svg xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
                width="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </div>
            <input
              type="search"
              id="search-modal__input"
              class="search-modal__input"
              placeholder="Search docs"
              aria-label="Search docs"
            />
          </div>
    
          <button aria-label="Close" class="search-modal__close">
            <!-- https://pictogrammers.com/library/mdi/icon/close/ -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
              width="24"
              viewBox="0 0 24 24"
            >
              <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
            </svg>
          </button>
        </div>
        <div
          role="listbox"
          aria-label="Search results"
          id="search-modal__results"
          class="search-modal__results"
        ></div>
        <div class="search-modal__helper-text">
          <div>
            <kbd>↑</kbd> and <kbd>↓</kbd> to navigate •
            <kbd>Enter</kbd> to select •
            <kbd>Esc</kbd> to close • <kbd>/</kbd> to open
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            /*{{{Search Modal*/
            const language = 'local';
            initSearchModal();
            initPHPSearch(language).then((searchCallback) => {
                initSearchUI({language, searchCallback, limit: 30});
            });
            /*}}}*/
        });
    </script></body></html>